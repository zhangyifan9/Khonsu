import java util iter org apach lucen index directori reader privat final hash set sync hash set privat map norm cach hash map directori reader directori segment info segment reader int map boolean boolean int map segment reader hash map reader null int info size norm cach null privat byte open directori index delet polici index commit boolean int return index reader segment info find segment file directori protect object bodi string segment file throw corrupt index segment info info segment info info read directori segment file read onli return read onli directori reader directori info delet polici term info index divisor els return directori reader directori info delet polici fals term info index divisor run commit reopen writer boolean index commit commit null els return index reader segment info find segment file directori protect object bodi string segment file throw corrupt index segment info info segment info info read directori segment file return reopen info fals open read onli run commit reopen segment info boolean boolean reader set disabl fake norm disabl fake norm fake norm null return norm string byte byte byte norm cach field norm string byte int byte byte byte norm cach field commit commit null commit map chang field index reader field option index reader set field set hash set int reader length set disabl fake norm boolean super set disabl fake norm disabl fake norm int reader length list commit directori collect commit array list 