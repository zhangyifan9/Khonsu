import java file input stream import java file output stream import java util hash map import java util map import org apach lucen index index file filter import org apach lucen index index writer org apach lucen store directori privat static final map hash map privat static boolean disabl lock fals public static final string system properti org apach lucen lock dir system properti java tmpdir default class implement filesystem base directori privat static class privat byte buffer null privat int ref count directori directori file lock factori init path lock factori ref count set disabl lock boolean directori disabl lock disabl lock disabl lock return directori disabl lock directori string return directori file path null directori string lock factori return directori file path lock factori directori file return directori file null directori file lock factori file canon path file directori dir return dir directori string boolean return directori file path creat directori file boolean directori dir directori file null creat return dir creat directori exist lock factori clear lock index writer init file lock factori set lock factori cascad default instanc pass els lock disabl lock factori els system properti org apach lucen store directori lock factori class set instanti els simpl lock factori directori path directori exist directori directori lock factori null set lock factori lock factori lock factori instanceof lock factori list ensur open return directori list index file filter filter renam file string string ensur open file file directori file file directori exist renam creat output string init output return index output file directori sync string success retri count open input string int ensur open return index input file directori buffer size lock string buffer buf string buffer close open ref count 