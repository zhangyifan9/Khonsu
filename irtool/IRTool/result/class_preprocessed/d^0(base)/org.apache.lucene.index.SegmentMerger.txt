import java util iter import org apach lucen document field selector import org apach lucen document field selector result org apach lucen index segment merger privat list reader array list segment merger directori string check abort check abort null null public void work doubl unit throw merg abort noth segment merger index writer string merg polici merg els segment reader int return index reader reader close reader iter iter reader iter merg file set file set hash set creat compound file string collect file merg file iter file iter add index index reader field info collect boolean boolean boolean boolean boolean iter iter set match segment reader int num reader merg field iter iter reader iter merg doc store els copi field delet field selector field writer index reader field reader int doc count final int max doc reader max doc match field reader null els return doc count copi field delet field selector field writer index reader field reader final int max doc reader max doc int doc count match field reader null els return doc count merg vector tri merg term info format post field consum int reader count queue size merg norm tri 